TLS 握手完成了 3 个主要任务：
    1、协商交换密码套件和参数
    2、验证一方或双方的身份
    3、创建/交换对称会话密钥

1、协商交换密码套件和参数
    每个软件都是不同的。 Web 浏览器是最常见的客户端，Google Chrome、Mozilla Firefox 和 Microsoft Internet Explorer 等流行浏览器的功能可能有所不同。 同样，在服务器端，Windows Server、Apache 和 NGINX 等流行操作系统都有非常不同的功能支持。 当您添加自定义配置时，所有这一切都变得更加复杂。 因此，TLS 握手的第一步要求客户端和服务器共享其功能，以便它们能够找到相互支持的加密功能。一旦客户端和服务器就他们将使用的确切加密方法达成一致（称为密码套件），服务器就会向客户端发送其 SSL 证书。

2、验证一方或双方的身份
    收到证书后，客户会检查以确保证书是“真实的”。 这是极其重要的一步。 要真正拥有安全的连接，您不能只是加密数据，您还需要知道数据被发送到正确的网站/组织。 SSL/TLS 证书提供该身份验证。 但他们的做法取决于所使用的密码套件。所有受信任的 SSL 证书均由证书颁发机构 (CA) 颁发，该机构是已获批准颁发数字证书的公司。 这些组织必须遵循严格的颁发和验证准则，以便他们颁发的证书继续受到信任。 这主要是为了确保您只能获得您真正拥有的网站或公司的证书。 在这种情况下，您可以将 CA 视为公证人 - 它的签名表明证书上的实体就是它所说的那个实体。
    在 TLS 握手的身份验证部分期间，客户端执行多项加密安全检查，以确保服务器提供的证书是真实的。 这包括检查数字签名并确保证书来自受信任的 CA。
    在此阶段，客户端还会验证服务器是否拥有与证书关联的私钥。 所有 SSL 证书都包含由公钥和私钥组成的密钥对。 公钥用于加密数据，私钥用于解密。 这被称为“非对称”公钥加密，因为这两个功能是由不同的密钥执行的。 加密实际上是单向的。
    使用最常见的公钥密码系统 RSA，客户端将使用需要用于生成会话密钥的公钥来加密随机数据。 服务器只有拥有提供所有权证明的私钥才能解密和使用该数据。
    如果使用另一种类型的密码系统（例如 ECC），则此过程会发生变化，但始终会检查所有权证明。

3、创建/交换对称会话密钥
    TLS 握手的最后一部分涉及创建“会话密钥”，这是实际用于安全通信的密钥。
    会话密钥是“对称的”，这意味着相同的密钥用于加密和解密。 这些密钥可以比非对称密钥更有效地实现强加密，从而适合在 HTTPS 连接中来回发送数据。
    生成密钥的确切方法根据所选的密码套件而有所不同，其中两种最常见的方案是 RSA 和 Diffie-Hellman。
    为了结束握手，各方让对方知道他们已经完成了所有必要的工作，然后双方都运行校验和以确保握手发生时没有任何恶意篡改或损坏。
    整个 SSL 握手发生在几百毫秒内，并且全部在幕后进行。 这是 HTTPS 连接中必须发生的第一件事，甚至在网页加载之前。
    SSL 握手完成后，加密且经过身份验证的 HTTPS 连接就会开始，您和服务器之间发送和接收的所有数据都会受到保护。



## 比较
TCP三次握手和TLS握手是两种不同协议中的握手过程区别：
目的不同：
	TCP三次握手：用于建立可靠的TCP连接。
	TLS握手：用于建立安全的加密通信通道。
过程不同：
	TCP三次握手：包括SYN、SYN-ACK、ACK三步。
	TLS握手：包括ClientHello、ServerHello、服务器证书、密钥交换、ChangeCipherSpec、Finished等多个步骤。
加密与否：
	TCP三次握手：不涉及加密，仅用于连接建立。
	TLS握手：涉及加密算法的协商、密钥交换和身份验证，用于建立加密连接。


# ja3 指纹组成格式
    样例：771,4865-4866-4867-49195-49199-49196-49200-52393-52392-49171-49172-156-157-47-53,0-23-65281-10-11-35-16-5-13-18-51-45-43-27-17513-21,29-23-24,0
    第一个值：771
        表示 JA3 版本，即用于生成指纹的 JA3 脚本的版本。
    第二个值：4865-4866-4867-49195-49199-49196-49200-52393-52392-49171-49172-156-157-47-53
        表示加密套件，即客户端可以支持的加密算法。
    第三个值：0-23-65281-10-11-35-16-5-13-18-51-45-43-27-17513-21
        表示支持的压缩算法。
    第四个值：29-23-24
        表示支持的 TLS 扩展，如 SNI。
    第五个值：0
        表示支持的 elliptic curves，即椭圆曲线算法。
